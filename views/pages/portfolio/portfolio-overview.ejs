<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/chart.js"></script>


<div id="portfolio-overview" v-cloak>

    <div class="container mb-3">
        <a class="text-white " href="/welcome">❮</a>
        <div class="row">
            <div class="col-8 ">
                <h1>Your Portfolio </h1>
            </div>
            <div class="col-3 justify-content-end">
                    <a href="/trans" class="text-reset btn ml-auto" id="defi-button-mobile" style="margin-right: 0">+ | -</a>
            </div>
        </div>
    </div>



    </div>
    <div class="container my-auto " style="max-height: 500px; min-height: 100px;">
        <div class = "chartBox d-flex justify-content-center" style="height: 500px">
            <canvas id="myChart"  height="500px" aria-label="Hello ARIA World" role="img"></canvas>
        </div>
    </div>



    <div class="container tbl-container">
        <div class="row tbl-fixed">
            <div class="table">
                <table class="table table-striped table-dark">
                    <thead class="sticky-top">
                    <tr class="info">
                        <th>Token</th>
                        <th>Amount</th>
                        <th>Value</th>
                        <th>Change</th>
                        <th>%</th>
                        <th>±</th>
                    </tr>
                    </thead>


                    <tbody >
                        <% if (tokenData) { %>
                            <% tokenData.forEach( token => { %>
                                <tr>
                                    <td class="sticky">
                                        <%= token.symbol; %>
                                    </td>
                                    <td>
                                        <%= token.amount; %>
                                    </td>
                                    <td>
                                        <%= token.currentValue; %>$
                                    </td>
                                    <% if (token.profitInUSD > 0) { %>
                                        <td style="color: green">
                                    <% } else { %>
                                        <td style ="color: red">
                                    <% } %>
                                        <%- token.profitInUSD %>$
                                    </td>
                                    <% if (token.profitInPercent > 0) { %>
                                    <td style="color: green">
                                        <% } else { %>
                                    <td style ="color: red">
                                        <% } %>
                                        <%= token.profitInPercent; %>%
                                    </td>
                                    <td>
                                        <a class="text-decoration-none text-white" href="/trans-02/<%=token.id%>">±</a>
                                    </td>
                                </tr>
                        <% }); }%>
                        </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
    <!-- Needs to be there to be queried by function createChart() in portfolio-overview.page-js !-->
    <div id ="token" hidden="hidden" >
        <%= JSON.stringify(tokenData);  %>
    </div>
    <div id="pV" hidden="hidden">
        <%- portfolioValue%>$
    </div>

<script>
  let token = '<%- JSON.stringify(tokenData) %>'  ;
  token = JSON.parse(token);

</script>

</div>

<style>
  .table th:first-child,
  .table td:first-child {
    position: sticky;
    left: 0;
  }
</style>



